# üéâ Deployment Complete - –í—Å–µ —Å–∏—Å—Ç–µ–º—ã –∑–∞–ø—É—â–µ–Ω—ã!

## ‚úÖ –°—Ç–∞—Ç—É—Å —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è 004 (FX Rates System) –ø—Ä–∏–º–µ–Ω–µ–Ω–∞
- ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è 005 (City Markups) –ø—Ä–∏–º–µ–Ω–µ–Ω–∞
- ‚úÖ 2 –∏—Å—Ç–æ—á–Ω–∏–∫–∞ —Å–æ–∑–¥–∞–Ω—ã (Grinex, Rapira)
- ‚úÖ 4 –ø–∞—Ä—ã –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã (USDT/RUB, BTC/USDT –¥–ª—è –æ–±–æ–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤)
- ‚úÖ 8 –ø—Ä–∞–≤–∏–ª –Ω–∞—Ü–µ–Ω–∫–∏ (1 –≥–ª–æ–±–∞–ª—å–Ω–æ–µ + 7 –≥–æ—Ä–æ–¥–æ–≤)

### –ò—Å—Ç–æ—á–Ω–∏–∫–∏ (FX Sources)
```sql
ID | Code   | Name            | Status
1  | grinex | Grinex Exchange | Enabled
2  | rapira | Rapira Exchange | Enabled
```

### –ü–∞—Ä—ã (FX Source Pairs)
```sql
ID | Source | Symbol       | Internal
1  | grinex | USDTRUB      | USDT/RUB
2  | grinex | BTCUSDT      | BTC/USDT
3  | rapira | usdtrub      | USDT/RUB
4  | rapira | btcusdt      | BTC/USDT
```

### –ü—Ä–∞–≤–∏–ª–∞ –Ω–∞—Ü–µ–Ω–∫–∏ (City Markups)
```sql
ID | Percent | –ì–æ—Ä–æ–¥
2  | 0.0%    | –ú–æ—Å–∫–≤–∞ (–±–∞–∑–æ–≤—ã–π)
3  | 0.3%    | –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥
6  | 0.7%    | –ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥
5  | 0.8%    | –ù–∏–∂–Ω–∏–π –ù–æ–≤–≥–æ—Ä–æ–¥
7  | 0.9%    | –ö–∞–∑–∞–Ω—å
4  | 1.0%    | –†–æ—Å—Ç–æ–≤-–Ω–∞-–î–æ–Ω—É
8  | 1.5%    | –î—Ä—É–≥–∏–µ –≥–æ—Ä–æ–¥–∞
```

### –°–µ—Ä–≤–∏—Å—ã Docker
```
‚úÖ postgres  - Running (port 5432)
‚úÖ redis     - Running (port 6379)
‚úÖ webadmin  - Running (port 8000)
‚úÖ bot       - Running (–∫–æ–Ω—Ñ–ª–∏–∫—Ç —Å –¥—Ä—É–≥–∏–º —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–º - —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ dev)
```

### –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∏
```
‚úÖ Legacy Scheduler - –ó–∞–ø—É—â–µ–Ω
‚úÖ Rapira Rates Scheduler - –ó–∞–ø—É—â–µ–Ω
‚úÖ FX Rates Scheduler - –ó–∞–ø—É—â–µ–Ω (–∏–Ω—Ç–µ—Ä–≤–∞–ª: 60s)
```

## üåê Web Admin - –î–æ—Å—Ç—É–ø–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã

### –ì–ª–∞–≤–Ω—ã–π –¥–∞—à–±–æ—Ä–¥
**URL**: http://localhost:8000/admin

**–ö–∞—Ä—Ç–æ—á–∫–∏ –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞:**
1. üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ ‚Üí `/admin/users`
2. üìÑ –ó–∞—è–≤–∫–∏ ‚Üí `/admin/orders`
3. üí¨ Live —á–∞—Ç—ã ‚Üí `/admin/live-chats`
4. üîî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è ‚Üí `/admin/notifications`
5. üìà **Rapira API** ‚Üí `/rapira`

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ (–Ω–æ–≤—ã–π —Ä—è–¥):**
6. üåä **Grinex Exchange** ‚Üí `/admin/fx/sources`
7. üî• **FX Rates System** ‚Üí `/admin/fx/rates`
8. üíú **Markup Rules** ‚Üí `/admin/fx/markup-rules`
9. üåç **–ö—É—Ä—Å—ã –ø–æ –≥–æ—Ä–æ–¥–∞–º** ‚Üí `/admin/city-rates` ‚Üê **–ù–û–í–û–ï!**

### FX –ú–æ–¥—É–ª—å
- `/admin/fx/sources` - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏ (Grinex, Rapira)
- `/admin/fx/sources/1/pairs` - –ü–∞—Ä—ã Grinex
- `/admin/fx/sources/2/pairs` - –ü–∞—Ä—ã Rapira
- `/admin/fx/rates` - –¢–µ–∫—É—â–∏–µ –∫—É—Ä—Å—ã —Å –Ω–∞—Ü–µ–Ω–∫–∞–º–∏
- `/admin/fx/markup-rules` - CRUD –ø—Ä–∞–≤–∏–ª –Ω–∞—Ü–µ–Ω–∫–∏
- `/admin/fx/logs` - –õ–æ–≥–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

### City Rates (–Ω–æ–≤–æ–µ!)
- `/admin/city-rates` - **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—É—Ä—Å–∞–º–∏ –ø–æ –≥–æ—Ä–æ–¥–∞–º**
  - –¢–∞–±–ª–∏—Ü–∞ –Ω–∞—Ü–µ–Ω–æ–∫ –ø–æ –≥–æ—Ä–æ–¥–∞–º
  - –ö–∞—Ä—Ç–æ—á–∫–∏ —Å —Ç–µ–∫—É—â–∏–º–∏ –∫—É—Ä—Å–∞–º–∏
  - –ë–∞–∑–æ–≤—ã–π –∫—É—Ä—Å Rapira (Ask/Bid/Spread)
  - –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞—Ü–µ–Ω–æ–∫

### Rapira Monitoring
- `/rapira` - –ü–æ–ª–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ Rapira API
- `/rapira/settings` - –ù–∞—Å—Ç—Ä–æ–π–∫–∏
- `/rapira/test` - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

## üîß API Endpoints

### FX Rates API
```bash
# –ü–æ–ª—É—á–∏—Ç—å –∫—É—Ä—Å
GET /api/fx/rates?base=USDT&quote=RUB&source=rapira

# –í—Å–µ –∫—É—Ä—Å—ã
GET /api/fx/rates

# –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
POST /api/fx/sync?source=rapira

# –°—Ç–∞—Ç—É—Å –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞
GET /api/fx/scheduler/status
```

### City Rates API (–Ω–æ–≤–æ–µ!)
```bash
# –ö—É—Ä—Å –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –≥–æ—Ä–æ–¥–∞
GET /api/city-rate/rostov/USDT%2FRUB?operation=buy

# –ö—É—Ä—Å—ã –≤—Å–µ—Ö –≥–æ—Ä–æ–¥–æ–≤
GET /api/city-rates/all/USDT%2FRUB?operation=buy

# –ë–∞–∑–æ–≤—ã–π –∫—É—Ä—Å Rapira
GET /api/rapira/base-rate/USDT%2FRUB

# –û–±–Ω–æ–≤–∏—Ç—å –Ω–∞—Ü–µ–Ω–∫—É –≥–æ—Ä–æ–¥–∞
POST /api/city-rates/update-markup
  city=rostov&percent=1.2
```

## ü§ñ Telegram Bot - –ö–æ–º–∞–Ω–¥—ã

### –û—Å–Ω–æ–≤–Ω—ã–µ
- `/admin` - –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
- `/grinex_status` - –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è Grinex
- `/rapira_status` - –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è Rapira
- `/grinex_help` - –°–ø—Ä–∞–≤–∫–∞ –ø–æ Grinex
- `/rapira_help` - –°–ø—Ä–∞–≤–∫–∞ –ø–æ Rapira

### –ù–∞–≤–∏–≥–∞—Ü–∏—è –≤ –±–æ—Ç–µ
```
/admin
  ‚îî‚îÄ‚îÄ üåê –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ (–Ω–æ–≤–æ–µ!)
       ‚îú‚îÄ‚îÄ üü¢ Grinex Exchange    ‚Üí /grinex_status
       ‚îú‚îÄ‚îÄ üü¢ Rapira Exchange    ‚Üí /rapira_status
       ‚îî‚îÄ‚îÄ üìä FX Rates System    ‚Üí –°—Ç–∞—Ç—É—Å –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞
```

## üìä –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### 1. –ü–æ–ª—É—á–∏—Ç—å –∫—É—Ä—Å –¥–ª—è –†–æ—Å—Ç–æ–≤–∞

**Web Admin:**
```
http://localhost:8000/admin/city-rates
‚Üí –í–∏–¥–∏—Ç–µ –∫–∞—Ä—Ç–æ—á–∫—É "–†–æ—Å—Ç–æ–≤-–Ω–∞-–î–æ–Ω—É"
‚Üí –ë–∞–∑–æ–≤—ã–π: 81.83 ‚ÇΩ
‚Üí –§–∏–Ω–∞–ª—å–Ω—ã–π: 82.65 ‚ÇΩ
‚Üí –ù–∞—Ü–µ–Ω–∫–∞: +1%
```

**API:**
```bash
curl "http://localhost:8000/api/city-rate/rostov/USDT%2FRUB?operation=buy"
```

**Python:**
```python
from src.services.rapira_simple import get_city_rate

rate = await get_city_rate("USDT/RUB", "rostov", "buy")
print(f"–ö—É—Ä—Å –¥–ª—è –†–æ—Å—Ç–æ–≤–∞: {rate['final_rate']:.2f} ‚ÇΩ")
# –í—ã–≤–æ–¥: –ö—É—Ä—Å –¥–ª—è –†–æ—Å—Ç–æ–≤–∞: 82.65 ‚ÇΩ
```

### 2. –ò–∑–º–µ–Ω–∏—Ç—å –Ω–∞—Ü–µ–Ω–∫—É –≥–æ—Ä–æ–¥–∞

**Web Admin:**
```
http://localhost:8000/admin/city-rates
‚Üí –ö–Ω–æ–ø–∫–∞ "–ò–∑–º–µ–Ω–∏—Ç—å" –Ω–∞–ø—Ä–æ—Ç–∏–≤ –≥–æ—Ä–æ–¥–∞
‚Üí –í–≤–µ—Å—Ç–∏ –Ω–æ–≤—É—é –Ω–∞—Ü–µ–Ω–∫—É (–Ω–∞–ø—Ä–∏–º–µ—Ä: 1.2)
‚Üí –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
```

**SQL:**
```sql
UPDATE fx_markup_rule
SET percent = 1.2
WHERE description ILIKE '%–≥–æ—Ä–æ–¥: rostov%';
```

### 3. –ü–æ–ª—É—á–∏—Ç—å –±–∞–∑–æ–≤—ã–π –∫—É—Ä—Å Rapira

**API:**
```bash
curl "http://localhost:8000/api/rapira/base-rate/USDT%2FRUB"
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "symbol": "USDT/RUB",
  "best_ask": 81.83,
  "best_bid": 81.50,
  "timestamp": "2025-10-13T19:22:00"
}
```

## üìù –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

### –°—Ö–µ–º–∞
```
1. Rapira API
   https://api.rapira.net/market/exchange-plate-mini?symbol=USDT/RUB
   ‚Üì
   Best Ask: 81.83 ‚ÇΩ (–±–∞–∑–æ–≤—ã–π –∫—É—Ä—Å –ú–æ—Å–∫–≤—ã)

2. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –Ω–∞—Ü–µ–Ω–æ–∫
   –ú–æ—Å–∫–≤–∞:     81.83 √ó (1 + 0.0/100)  = 81.83 ‚ÇΩ
   –°–ü–±:        81.83 √ó (1 + 0.3/100)  = 82.08 ‚ÇΩ
   –†–æ—Å—Ç–æ–≤:     81.83 √ó (1 + 1.0/100)  = 82.65 ‚ÇΩ
   –ù.–ù–æ–≤–≥–æ—Ä–æ–¥: 81.83 √ó (1 + 0.8/100)  = 82.48 ‚ÇΩ

3. –ö–ª–∏–µ–Ω—Ç—É
   –í–∞—à –∫—É—Ä—Å: 82.65 ‚ÇΩ
```

### –§–æ—Ä–º—É–ª–∞
```python
final_rate = base_rate * (1 + markup_percent/100) + fixed
```

## üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–∏—Å—Ç–µ–º—ã

```bash
# –°—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker-compose ps

# –õ–æ–≥–∏ FX –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞
docker-compose logs bot | grep "FX"

# –õ–æ–≥–∏ Rapira
docker-compose logs bot | grep -i rapira

# –õ–æ–≥–∏ webadmin
docker-compose logs webadmin
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ –ë–î

```bash
# –ü—Ä–∞–≤–∏–ª–∞ –Ω–∞—Ü–µ–Ω–∫–∏ –≥–æ—Ä–æ–¥–æ–≤
docker-compose exec postgres psql -U exchange -d exchange \
  -c "SELECT percent, description FROM fx_markup_rule WHERE description ILIKE '%–≥–æ—Ä–æ–¥%' ORDER BY percent;"

# –ò—Å—Ç–æ—á–Ω–∏–∫–∏
docker-compose exec postgres psql -U exchange -d exchange \
  -c "SELECT * FROM fx_source;"

# –¢–µ–∫—É—â–∏–µ –∫—É—Ä—Å—ã
docker-compose exec postgres psql -U exchange -d exchange \
  -c "SELECT * FROM fx_final_rate;"
```

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

| –î–æ–∫—É–º–µ–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|----------|
| `FX_RATES_README.md` | –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ FX –º–æ–¥—É–ª—é |
| `FX_IMPLEMENTATION_SUMMARY.md` | –î–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ FX |
| `QUICK_START_FX.md` | –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç FX |
| `GRINEX_ADMIN_GUIDE.md` | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Grinex —á–µ—Ä–µ–∑ –±–æ—Ç |
| `GRINEX_ADMIN_SUMMARY.md` | –ö—Ä–∞—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ Grinex |
| `CITY_RATES_README.md` | –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –≥–æ—Ä–æ–¥—Å–∫–∏–º –∫—É—Ä—Å–∞–º |
| `CITY_RATES_QUICKSTART.md` | –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –≥–æ—Ä–æ–¥—Å–∫–∏—Ö –∫—É—Ä—Å–æ–≤ |
| `RAPIRA_CITY_LOGIC_SUMMARY.md` | –õ–æ–≥–∏–∫–∞ Rapira –ø–æ –≥–æ—Ä–æ–¥–∞–º |
| `ADMIN_DASHBOARD_UPDATE.md` | –û–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞—à–±–æ—Ä–¥–∞ |

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- [x] –ú–∏–≥—Ä–∞—Ü–∏—è 004 –ø—Ä–∏–º–µ–Ω–µ–Ω–∞
- [x] –ú–∏–≥—Ä–∞—Ü–∏—è 005 –ø—Ä–∏–º–µ–Ω–µ–Ω–∞
- [x] 2 –∏—Å—Ç–æ—á–Ω–∏–∫–∞ —Å–æ–∑–¥–∞–Ω—ã
- [x] 4 –ø–∞—Ä—ã –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- [x] 8 –ø—Ä–∞–≤–∏–ª –Ω–∞—Ü–µ–Ω–∫–∏ (7 –≥–æ—Ä–æ–¥–æ–≤ + 1 –≥–ª–æ–±–∞–ª—å–Ω–æ–µ)

### –°–µ—Ä–≤–∏—Å—ã
- [x] Bot –ø–µ—Ä–µ—Å–æ–±—Ä–∞–Ω
- [x] Webadmin –ø–µ—Ä–µ—Å–æ–±—Ä–∞–Ω
- [x] FX Scheduler –∑–∞–ø—É—â–µ–Ω
- [x] –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã —Ä–∞–±–æ—Ç–∞—é—Ç

### Web Admin
- [x] –ì–ª–∞–≤–Ω—ã–π –¥–∞—à–±–æ—Ä–¥ –æ–±–Ω–æ–≤–ª–µ–Ω
- [x] 4 –Ω–æ–≤—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π
- [x] –°—Ç—Ä–∞–Ω–∏—Ü–∞ city-rates —Å–æ–∑–¥–∞–Ω–∞
- [x] API endpoints —Ä–∞–±–æ—Ç–∞—é—Ç

### Telegram Bot
- [x] Handler admin_grinex –¥–æ–±–∞–≤–ª–µ–Ω
- [x] –ú–µ–Ω—é –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π —Å–æ–∑–¥–∞–Ω–æ
- [x] –ö–æ–º–∞–Ω–¥—ã /grinex_status —Ä–∞–±–æ—Ç–∞—é—Ç

## üöÄ –ß—Ç–æ –¥–µ–ª–∞—Ç—å –¥–∞–ª—å—à–µ

### 1. –û—Ç–∫—Ä–æ–π—Ç–µ Web Admin
```
http://localhost:8000/admin
```

–õ–æ–≥–∏–Ω/–ø–∞—Ä–æ–ª—å –∏–∑ .env (ADMIN_LOGIN/ADMIN_PASSWORD)

### 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–æ–≤—ã–µ —Ä–∞–∑–¥–µ–ª—ã

**–ö–∞—Ä—Ç–æ—á–∫–∞ "–ö—É—Ä—Å—ã –ø–æ –≥–æ—Ä–æ–¥–∞–º":**
```
http://localhost:8000/admin/city-rates
```
- –£–≤–∏–¥–∏—Ç–µ —Ç–∞–±–ª–∏—Ü—É —Å –Ω–∞—Ü–µ–Ω–∫–∞–º–∏ –≤—Å–µ—Ö –≥–æ—Ä–æ–¥–æ–≤
- –ö–∞—Ä—Ç–æ—á–∫–∏ —Å —Ç–µ–∫—É—â–∏–º–∏ –∫—É—Ä—Å–∞–º–∏
- –ë–∞–∑–æ–≤—ã–π –∫—É—Ä—Å –∏–∑ Rapira

**–ö–∞—Ä—Ç–æ—á–∫–∞ "Grinex Exchange":**
```
http://localhost:8000/admin/fx/sources
```
- –°–ø–∏—Å–æ–∫ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ (Grinex, Rapira)
- –ö–Ω–æ–ø–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

**–ö–∞—Ä—Ç–æ—á–∫–∞ "FX Rates System":**
```
http://localhost:8000/admin/fx/rates
```
- –í—Å–µ —Ç–µ–∫—É—â–∏–µ –∫—É—Ä—Å—ã
- Raw –∏ Final —Ü–µ–Ω—ã
- –ü—Ä–∏–º–µ–Ω–µ–Ω–Ω—ã–µ –Ω–∞—Ü–µ–Ω–∫–∏

**–ö–∞—Ä—Ç–æ—á–∫–∞ "Markup Rules":**
```
http://localhost:8000/admin/fx/markup-rules
```
- CRUD –ø—Ä–∞–≤–∏–ª
- –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã
- –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø—Ä–∞–≤–∏–ª

### 3. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ API

```bash
# –ë–∞–∑–æ–≤—ã–π –∫—É—Ä—Å –∏–∑ Rapira
curl "http://localhost:8000/api/rapira/base-rate/USDT%2FRUB"

# –ö—É—Ä—Å—ã –≤—Å–µ—Ö –≥–æ—Ä–æ–¥–æ–≤
curl "http://localhost:8000/api/city-rates/all/USDT%2FRUB?operation=buy"

# –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –≥–æ—Ä–æ–¥
curl "http://localhost:8000/api/city-rate/rostov/USDT%2FRUB?operation=buy"
```

### 4. –í Telegram –±–æ—Ç–µ

```
/admin
‚Üí –ö–Ω–æ–ø–∫–∞ "üåê –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏"
‚Üí –í—ã–±–µ—Ä–∏—Ç–µ "üü¢ Grinex Exchange" –∏–ª–∏ "üü¢ Rapira Exchange"

/grinex_status
‚Üí –ü–æ–ª–Ω–∞—è –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è Grinex

/rapira_status  
‚Üí –ü–æ–ª–Ω–∞—è –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è Rapira
```

## üìä –ß—Ç–æ –≤—ã –º–æ–∂–µ—Ç–µ –¥–µ–ª–∞—Ç—å

### Web Admin

1. **–ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –∫—É—Ä—Å—ã –≤—Å–µ—Ö –≥–æ—Ä–æ–¥–æ–≤**
   - –°—Ä–∞–≤–Ω–∏–≤–∞—Ç—å –±–∞–∑–æ–≤—ã–π –∏ —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –∫—É—Ä—Å
   - –í–∏–¥–µ—Ç—å –Ω–∞—Ü–µ–Ω–∫—É –∫–∞–∂–¥–æ–≥–æ –≥–æ—Ä–æ–¥–∞

2. **–ò–∑–º–µ–Ω—è—Ç—å –Ω–∞—Ü–µ–Ω–∫–∏ –≤ 1 –∫–ª–∏–∫**
   - –ö–Ω–æ–ø–∫–∞ "–ò–∑–º–µ–Ω–∏—Ç—å" ‚Üí –ù–æ–≤—ã–π –ø—Ä–æ—Ü–µ–Ω—Ç ‚Üí –°–æ—Ö—Ä–∞–Ω–∏—Ç—å

3. **–ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫–∏**
   - Grinex –∏ Rapira —Å—Ç–∞—Ç—É—Å
   - –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
   - –õ–æ–≥–∏ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

4. **–£–ø—Ä–∞–≤–ª—è—Ç—å –ø—Ä–∞–≤–∏–ª–∞–º–∏**
   - –°–æ–∑–¥–∞–≤–∞—Ç—å –Ω–æ–≤—ã–µ –ø—Ä–∞–≤–∏–ª–∞
   - –£–¥–∞–ª—è—Ç—å –Ω–µ–Ω—É–∂–Ω—ã–µ
   - –í—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–∞—Ç—å

### Telegram Bot

1. **–ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å Grinex**
   - `/grinex_status` ‚Üí –°—Ç–∞—Ç—É—Å API, –∫—É—Ä—Å—ã, —Ç–∏–∫–µ—Ä—ã
   - –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
   - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API

2. **–ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å Rapira**
   - `/rapira_status` ‚Üí –°—Ç–∞—Ç—É—Å API, –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫
   - VWAP —Ä–∞—Å—á–µ—Ç—ã
   - –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

3. **–£–ø—Ä–∞–≤–ª—è—Ç—å —á–µ—Ä–µ–∑ –º–µ–Ω—é**
   - `/admin` ‚Üí "üåê –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏"
   - –î–æ—Å—Ç—É–ø –∫ –æ–±–µ–∏–º –±–∏—Ä–∂–∞–º
   - FX —Å–∏—Å—Ç–µ–º–µ

## üéØ –ë—ã—Å—Ç—Ä—ã–µ —Å—Å—ã–ª–∫–∏

| –†–∞–∑–¥–µ–ª | URL |
|--------|-----|
| **–ì–ª–∞–≤–Ω–∞—è –∞–¥–º–∏–Ω–∫–∞** | http://localhost:8000/admin |
| **–ö—É—Ä—Å—ã –ø–æ –≥–æ—Ä–æ–¥–∞–º** | http://localhost:8000/admin/city-rates |
| **FX Sources** | http://localhost:8000/admin/fx/sources |
| **FX Rates** | http://localhost:8000/admin/fx/rates |
| **Markup Rules** | http://localhost:8000/admin/fx/markup-rules |
| **FX Logs** | http://localhost:8000/admin/fx/logs |
| **Rapira Monitor** | http://localhost:8000/rapira |

## üí° –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
docker-compose logs -f bot webadmin

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
docker-compose restart bot webadmin

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ë–î
docker-compose exec postgres psql -U exchange -d exchange

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ø—Ä–∞–≤–∏–ª –≥–æ—Ä–æ–¥–æ–≤
docker-compose exec postgres psql -U exchange -d exchange \
  -c "SELECT percent, description FROM fx_markup_rule WHERE description ILIKE '%–≥–æ—Ä–æ–¥%';"

# –ò–∑–º–µ–Ω–∏—Ç—å –Ω–∞—Ü–µ–Ω–∫—É –≥–æ—Ä–æ–¥–∞
docker-compose exec postgres psql -U exchange -d exchange \
  -c "UPDATE fx_markup_rule SET percent = 1.2 WHERE description ILIKE '%rostov%';"
```

## üéì –û–±—É—á–µ–Ω–∏–µ

### –î–ª—è –Ω–∞—á–∞–ª–∞:
1. –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:8000/admin/city-rates
2. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ —Ç–µ–∫—É—â–∏–µ –∫—É—Ä—Å—ã –ø–æ –≥–æ—Ä–æ–¥–∞–º
3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –Ω–∞—Ü–µ–Ω–∫—É –ª—é–±–æ–≥–æ –≥–æ—Ä–æ–¥–∞
4. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É - –∫—É—Ä—Å –ø–µ—Ä–µ—Å—á–∏—Ç–∞–µ—Ç—Å—è

### –ó–∞—Ç–µ–º:
1. –ò–∑—É—á–∏—Ç–µ http://localhost:8000/admin/fx/sources
2. –ù–∞–∂–º–∏—Ç–µ "Sync Now" –¥–ª—è Rapira
3. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ http://localhost:8000/admin/fx/logs

### –í Telegram:
1. –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/grinex_status` –±–æ—Ç—É
2. –ò–∑—É—á–∏—Ç–µ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –º–µ–Ω—é
3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é

## ‚ö†Ô∏è Known Issues

### Telegram Conflict
```
ERROR: Conflict: terminated by other getUpdates request
```
**–†–µ—à–µ–Ω–∏–µ**: –ì–¥–µ-—Ç–æ –µ—â–µ –∑–∞–ø—É—â–µ–Ω –±–æ—Ç —Å —Ç–µ–º –∂–µ —Ç–æ–∫–µ–Ω–æ–º. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –¥—Ä—É–≥–æ–π —ç–∫–∑–µ–º–ø–ª—è—Ä –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥—Ä—É–≥–æ–π —Ç–æ–∫–µ–Ω –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏.

### Grinex API errors
```
ERROR: USDTRUB: no data
```
**–†–µ—à–µ–Ω–∏–µ**: Grinex API –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –∏–ª–∏ —Ç—Ä–µ–±—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `GRINEX_API_BASE` –≤ .env. –≠—Ç–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ - Rapira —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ.

## üìà –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

–ü–æ –ª–æ–≥–∞–º –±–æ—Ç–∞:
- ‚úÖ FX Scheduler –∑–∞–ø—É—â–µ–Ω —É—Å–ø–µ—à–Ω–æ
- ‚úÖ 2 –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –∑–∞–≥—Ä—É–∂–µ–Ω—ã
- ‚úÖ 4 –ø–∞—Ä—ã –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- ‚úÖ 8 –ø—Ä–∞–≤–∏–ª –Ω–∞—Ü–µ–Ω–∫–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã
- ‚ö†Ô∏è Grinex —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å –æ—à–∏–±–∫–∞–º–∏ (API –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω)
- ‚úÖ Rapira –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç

## üéâ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!

–í—Å–µ —Å–∏—Å—Ç–µ–º—ã —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—ã –∏ –≥–æ—Ç–æ–≤—ã –∫ —Ä–∞–±–æ—Ç–µ:

‚úÖ **FX Rates System** - —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∫—É—Ä—Å–æ–≤ —Å –±–∏—Ä–∂  
‚úÖ **City Rates** - –∫—É—Ä—Å—ã –ø–æ –≥–æ—Ä–æ–¥–∞–º —Å –Ω–∞—Ü–µ–Ω–∫–∞–º–∏  
‚úÖ **Grinex Integration** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –±–æ—Ç –∏ –∞–¥–º–∏–Ω–∫—É  
‚úÖ **Rapira Integration** - —É–ø—Ä–æ—â–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Å –≥–æ—Ä–æ–¥–∞–º–∏  
‚úÖ **Web Admin** - –∫—Ä–∞—Å–∏–≤—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è  
‚úÖ **Telegram Bot** - –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤  

---

**–û—Ç–∫—Ä–æ–π—Ç–µ:** http://localhost:8000/admin

**–ù–∞—á–Ω–∏—Ç–µ —Å:** http://localhost:8000/admin/city-rates

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** `CITY_RATES_README.md`, `CITY_RATES_QUICKSTART.md`

