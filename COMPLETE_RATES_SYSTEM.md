# ‚úÖ –ü–æ–ª–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫—É—Ä—Å–∞–º–∏

## –î–∞—Ç–∞: 14 –æ–∫—Ç—è–±—Ä—è 2025

---

## üéØ –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### 1. **–¢—Ä—ë—Ö—É—Ä–æ–≤–Ω–µ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –Ω–∞—Ü–µ–Ω–æ–∫**

```
1Ô∏è‚É£ –ë–∞–∑–æ–≤—ã–π –∫—É—Ä—Å –∏–∑ Rapira API
    ‚Üì
2Ô∏è‚É£ –ë–∞–∑–æ–≤–∞—è –Ω–∞—Ü–µ–Ω–∫–∞ –≥–æ—Ä–æ–¥–∞ (–¥–ª—è –≤—Å–µ—Ö –ø–∞—Ä)
    ‚Üì
3Ô∏è‚É£ –°–ø–µ—Ü–∏—Ñ–∏—á–Ω–∞—è –Ω–∞—Ü–µ–Ω–∫–∞ –≥–æ—Ä–æ–¥–∞+–ø–∞—Ä—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
```

**–ü—Ä–∏–º–µ—Ä:**
- –ú–æ—Å–∫–≤–∞: –±–∞–∑–æ–≤–∞—è –Ω–∞—Ü–µ–Ω–∫–∞ 0%
  - USDT/RUB: 0% (–±–∞–∑–æ–≤–∞—è)
  - BTC/USDT: 0.5% (—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–∞—è –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –±–∞–∑–æ–≤—É—é!)
  
- –†–æ—Å—Ç–æ–≤: –±–∞–∑–æ–≤–∞—è –Ω–∞—Ü–µ–Ω–∫–∞ 1%
  - USDT/RUB: 1% (–±–∞–∑–æ–≤–∞—è)
  - BTC/USDT: 1.5% (—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–∞—è)

---

## üìÇ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### –¢–∞–±–ª–∏—Ü–∞ `cities`:
```sql
id, code, name, markup_percent, markup_fixed, enabled, sort_order
```
**–•—Ä–∞–Ω–∏—Ç –±–∞–∑–æ–≤—ã–µ –Ω–∞—Ü–µ–Ω–∫–∏ –≥–æ—Ä–æ–¥–æ–≤ –¥–ª—è –≤—Å–µ—Ö –ø–∞—Ä**

### –¢–∞–±–ª–∏—Ü–∞ `city_pair_markups`:
```sql
id, city_id, pair_symbol, markup_percent, markup_fixed, enabled
```
**–•—Ä–∞–Ω–∏—Ç —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –Ω–∞—Ü–µ–Ω–∫–∏ –≥–æ—Ä–æ–¥+–ø–∞—Ä–∞ (–ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è—é—Ç –±–∞–∑–æ–≤—ã–µ)**

**–õ–æ–≥–∏–∫–∞:**
```sql
COALESCE(city_pair_markups.markup, cities.markup) -- –ï—Å–ª–∏ –µ—Å—Ç—å —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–∞—è - –±–µ—Ä—ë–º –µ—ë, –∏–Ω–∞—á–µ –±–∞–∑–æ–≤—É—é
```

---

## üöÄ –ë—ã—Å—Ç—Ä–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∫—É—Ä—Å–æ–≤

### –ë—ã–ª–æ (–º–µ–¥–ª–µ–Ω–Ω–æ):
```python
for city in cities:
    rate = await get_city_rate(symbol, city)  # 7 –∑–∞–ø—Ä–æ—Å–æ–≤!
```

### –°—Ç–∞–ª–æ (–±—ã—Å—Ç—Ä–æ):
```python
# 1 –∑–∞–ø—Ä–æ—Å –∫ Rapira API
base_rate = await client.get_base_rate(symbol)

# 1 –∑–∞–ø—Ä–æ—Å –∫ –ë–î –¥–ª—è –≤—Å–µ—Ö –≥–æ—Ä–æ–¥–æ–≤ —Å –Ω–∞—Ü–µ–Ω–∫–∞–º–∏
cities_data = await conn.fetch("""
    SELECT c.*, COALESCE(cpm.markup_percent, c.markup_percent)
    FROM cities c
    LEFT JOIN city_pair_markups cpm ON cpm.city_id = c.id AND cpm.pair_symbol = $1
""", symbol)

# –í—ã—á–∏—Å–ª—è–µ–º –≤—Å–µ –∫—É—Ä—Å—ã –≤ —Ü–∏–∫–ª–µ
```

**–£—Å–∫–æ—Ä–µ–Ω–∏–µ: 7-10x –±—ã—Å—Ç—Ä–µ–µ!**

---

## üíª –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### –û—Ç–∫—Ä–æ–π—Ç–µ:
`http://localhost:8000/admin/rates-management`

### 4 –≤–∫–ª–∞–¥–∫–∏:

#### 1Ô∏è‚É£ –¢–µ–∫—É—â–∏–µ –∫—É—Ä—Å—ã
- **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π —Å–µ–ª–µ–∫—Ç–æ—Ä –ø–∞—Ä** (–ø–æ–¥–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏–∑ –≤–∫–ª–∞–¥–∫–∏ "–¢–æ—Ä–≥–æ–≤—ã–µ –ø–∞—Ä—ã")
- –¢–∞–±–ª–∏—Ü–∞ –∫—É—Ä—Å–æ–≤ –¥–ª—è –≤—Å–µ—Ö –≥–æ—Ä–æ–¥–æ–≤
- –ë—ã—Å—Ç—Ä–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ (1-2 –∑–∞–ø—Ä–æ—Å–∞ –≤–º–µ—Å—Ç–æ 7-14)

#### 2Ô∏è‚É£ –ì–æ—Ä–æ–¥—Å–∫–∏–µ –Ω–∞—Ü–µ–Ω–∫–∏
- –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –≥–æ—Ä–æ–¥–æ–≤
- –ë–∞–∑–æ–≤–∞—è –Ω–∞—Ü–µ–Ω–∫–∞ (–ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫–æ –≤—Å–µ–º –ø–∞—Ä–∞–º)
- –ö–Ω–æ–ø–∫–∞ "**–ü–æ –ø–∞—Ä–∞–º**" ‚Üí –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö –Ω–∞—Ü–µ–Ω–æ–∫
- –ö–Ω–æ–ø–∫–∞ "**‚ûï –î–æ–±–∞–≤–∏—Ç—å –≥–æ—Ä–æ–¥**"
- –ö–Ω–æ–ø–∫–∞ "**üóë –£–¥–∞–ª–∏—Ç—å**"

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
```
–ú–æ—Å–∫–≤–∞  [  0.0  ] % (–±–∞–∑–æ–≤–∞—è)  [–ü–æ –ø–∞—Ä–∞–º] [üóë]
  ‚Üì –ù–∞–∂–∏–º–∞–µ—Ç–µ "–ü–æ –ø–∞—Ä–∞–º"
  
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –ù–∞—Ü–µ–Ω–∫–∏ –ø–æ –ø–∞—Ä–∞–º: –ú–æ—Å–∫–≤–∞            ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ –ë–∞–∑–æ–≤–∞—è –Ω–∞—Ü–µ–Ω–∫–∞: 0%                 ‚îÇ
‚îÇ                                      ‚îÇ
‚îÇ –ü–∞—Ä–∞      ‚îÇ –ù–∞—Ü–µ–Ω–∫–∞ ‚îÇ –î–µ–π—Å—Ç–≤–∏—è      ‚îÇ
‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ
‚îÇ USDT/RUB  ‚îÇ [    ] % ‚îÇ [–°–æ—Ö—Ä–∞–Ω–∏—Ç—å]  ‚îÇ
‚îÇ BTC/USDT  ‚îÇ [ 0.5] % ‚îÇ [–°–æ—Ö—Ä–∞–Ω–∏—Ç—å] [X]‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

#### 3Ô∏è‚É£ –¢–æ—Ä–≥–æ–≤—ã–µ –ø–∞—Ä—ã
- –¢–∞–±–ª–∏—Ü–∞ –≤—Å–µ—Ö –ø–∞—Ä –∏–∑ –≤—Å–µ—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
- –ö–Ω–æ–ø–∫–∞ "**‚ûï –î–æ–±–∞–≤–∏—Ç—å –ø–∞—Ä—É**"
- –£–∫–∞–∑–∞–Ω–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ (Rapira/Grinex)
- –£–∫–∞–∑–∞–Ω–∏–µ endpoint (—Å–∏–º–≤–æ–ª–∞ –≤ API)
- –ö–Ω–æ–ø–∫–∞ "**üóë**" –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è

#### 4Ô∏è‚É£ –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö
- Rapira / Grinex - –≤–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å
- –ò—Å—Ç–æ—Ä–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–π
- –ö–Ω–æ–ø–∫–∞ "–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å"

---

## üåê API Endpoints

### –ì–æ—Ä–æ–¥–∞:
```http
GET    /api/cities              - –°–ø–∏—Å–æ–∫ –≥–æ—Ä–æ–¥–æ–≤
POST   /api/cities              - –°–æ–∑–¥–∞—Ç—å –≥–æ—Ä–æ–¥
PUT    /api/cities/{id}        - –û–±–Ω–æ–≤–∏—Ç—å –≥–æ—Ä–æ–¥
DELETE /api/cities/{id}        - –£–¥–∞–ª–∏—Ç—å –≥–æ—Ä–æ–¥
```

### –ù–∞—Ü–µ–Ω–∫–∏ –≥–æ—Ä–æ–¥+–ø–∞—Ä–∞:
```http
GET    /api/city-pair-markups              - –°–ø–∏—Å–æ–∫ –Ω–∞—Ü–µ–Ω–æ–∫
       ?city_id=1&pair_symbol=USDT/RUB
POST   /api/city-pair-markups              - –°–æ–∑–¥–∞—Ç—å –Ω–∞—Ü–µ–Ω–∫—É
DELETE /api/city-pair-markups/{id}         - –£–¥–∞–ª–∏—Ç—å –Ω–∞—Ü–µ–Ω–∫—É
```

### –¢–æ—Ä–≥–æ–≤—ã–µ –ø–∞—Ä—ã:
```http
GET    /api/fx/all-pairs           - –í—Å–µ –ø–∞—Ä—ã
POST   /api/fx/source-pairs        - –î–æ–±–∞–≤–∏—Ç—å –ø–∞—Ä—É
DELETE /api/fx/source-pairs/{id}   - –£–¥–∞–ª–∏—Ç—å –ø–∞—Ä—É
```

### –ö—É—Ä—Å—ã (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ):
```http
GET /api/city-rates/all?symbol=USDT/RUB
# –¢–µ–ø–µ—Ä—å –¥–µ–ª–∞–µ—Ç 2 –∑–∞–ø—Ä–æ—Å–∞ –≤–º–µ—Å—Ç–æ 7-14!
```

---

## üìù –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –†–∞–∑–Ω—ã–µ –Ω–∞—Ü–µ–Ω–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø–∞—Ä

**–ó–∞–¥–∞—á–∞:** –í –ú–æ—Å–∫–≤–µ USDT/RUB –±–µ–∑ –Ω–∞—Ü–µ–Ω–∫–∏, –∞ BTC/USDT —Å –Ω–∞—Ü–µ–Ω–∫–æ–π 0.5%

**–†–µ—à–µ–Ω–∏–µ:**
1. –û—Ç–∫—Ä—ã—Ç—å –≤–∫–ª–∞–¥–∫—É "–ì–æ—Ä–æ–¥—Å–∫–∏–µ –Ω–∞—Ü–µ–Ω–∫–∏"
2. –ù–∞–π—Ç–∏ "–ú–æ—Å–∫–≤–∞", –±–∞–∑–æ–≤–∞—è –Ω–∞—Ü–µ–Ω–∫–∞ = `0%`
3. –ù–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É "**–ü–æ –ø–∞—Ä–∞–º**"
4. –ù–∞–π—Ç–∏ —Å—Ç—Ä–æ–∫—É "BTC/USDT"
5. –í–≤–µ—Å—Ç–∏ `0.5` –≤ –ø–æ–ª–µ –Ω–∞—Ü–µ–Ω–∫–∏
6. –ù–∞–∂–∞—Ç—å "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- USDT/RUB –≤ –ú–æ—Å–∫–≤–µ: –±–∞–∑–æ–≤—ã–π –∫—É—Ä—Å + 0% = 81.82 RUB
- BTC/USDT –≤ –ú–æ—Å–∫–≤–µ: –±–∞–∑–æ–≤—ã–π –∫—É—Ä—Å + 0.5% = 115750 USDT

---

### –ü—Ä–∏–º–µ—Ä 2: –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é –ø–∞—Ä—É ETH/USDT

1. –í–∫–ª–∞–¥–∫–∞ "**–¢–æ—Ä–≥–æ–≤—ã–µ –ø–∞—Ä—ã**"
2. –ö–Ω–æ–ø–∫–∞ "**‚ûï –î–æ–±–∞–≤–∏—Ç—å –ø–∞—Ä—É**"
3. –ó–∞–ø–æ–ª–Ω–∏—Ç—å:
   - –ò—Å—Ç–æ—á–Ω–∏–∫: `Rapira Exchange`
   - –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π: `ETH/USDT`
   - –°–∏–º–≤–æ–ª API: `ETH/USDT`
4. –ù–∞–∂–∞—Ç—å "–î–æ–±–∞–≤–∏—Ç—å"

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –ü–∞—Ä–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ —Å–µ–ª–µ–∫—Ç–æ—Ä –Ω–∞ –≤–∫–ª–∞–¥–∫–µ "–¢–µ–∫—É—â–∏–µ –∫—É—Ä—Å—ã"
- ‚úÖ –ù–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∫—É—Ä—Å–æ–≤
- ‚úÖ –ü–∞—Ä–∞ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –≤ –±–æ—Ç–µ

---

### –ü—Ä–∏–º–µ—Ä 3: –î–æ–±–∞–≤–∏—Ç—å –≥–æ—Ä–æ–¥ –í–æ—Ä–æ–Ω–µ–∂

1. –í–∫–ª–∞–¥–∫–∞ "**–ì–æ—Ä–æ–¥—Å–∫–∏–µ –Ω–∞—Ü–µ–Ω–∫–∏**"
2. –ö–Ω–æ–ø–∫–∞ "**‚ûï –î–æ–±–∞–≤–∏—Ç—å –≥–æ—Ä–æ–¥**"
3. –ó–∞–ø–æ–ª–Ω–∏—Ç—å:
   - –ö–æ–¥: `voronezh`
   - –ù–∞–∑–≤–∞–Ω–∏–µ: `–í–æ—Ä–æ–Ω–µ–∂`
   - –ù–∞—Ü–µ–Ω–∫–∞: `0.8`
4. –ù–∞–∂–∞—Ç—å "–î–æ–±–∞–≤–∏—Ç—å"

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –ì–æ—Ä–æ–¥ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –≤ –∞–¥–º–∏–Ω–∫–µ
- ‚úÖ –ì–æ—Ä–æ–¥ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –≤ –±–æ—Ç–µ (–∫–Ω–æ–ø–∫–∞ "üèô –í–æ—Ä–æ–Ω–µ–∂")
- ‚úÖ –ö—É—Ä—Å—ã –¥–ª—è –í–æ—Ä–æ–Ω–µ–∂–∞ = –±–∞–∑–æ–≤—ã–π + 0.8%

---

## ü§ñ –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ Telegram –±–æ—Ç–µ

### –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã:

**–ì–æ—Ä–æ–¥–∞** (`get_cities_keyboard`):
- –ß–∏—Ç–∞–µ—Ç –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `cities`
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ 60 —Å–µ–∫—É–Ω–¥
- –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –≥–æ—Ä–æ–¥–∞

**–¢–æ—Ä–≥–æ–≤—ã–µ –ø–∞—Ä—ã** (`get_pairs_for_fsm`):
- –ß–∏—Ç–∞–µ—Ç –∏–∑ `fx_source_pair`
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–µ (`enabled = true`)
- –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –ø–∞—Ä—ã

---

## ‚ö° –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

| –û–ø–µ—Ä–∞—Ü–∏—è | –ë—ã–ª–æ | –°—Ç–∞–ª–æ | –£—Å–∫–æ—Ä–µ–Ω–∏–µ |
|----------|------|-------|-----------|
| –ó–∞–≥—Ä—É–∑–∫–∞ –∫—É—Ä—Å–æ–≤ –¥–ª—è 7 –≥–æ—Ä–æ–¥–æ–≤ | 7-14 –∑–∞–ø—Ä–æ—Å–æ–≤ | 2 –∑–∞–ø—Ä–æ—Å–∞ | **7x** |
| –ó–∞–≥—Ä—É–∑–∫–∞ –≥–æ—Ä–æ–¥–æ–≤ –≤ –±–æ—Ç–µ | –°—Ç–∞—Ç–∏—á–Ω–æ | 1 –∑–∞–ø—Ä–æ—Å + –∫—ç—à | ‚àû |
| –ó–∞–≥—Ä—É–∑–∫–∞ –ø–∞—Ä –≤ –±–æ—Ç–µ | –°—Ç–∞—Ç–∏—á–Ω–æ | 1 –∑–∞–ø—Ä–æ—Å | ‚àû |
| –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≥–æ—Ä–æ–¥–∞ | –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ–¥–∞ | 3 –∫–ª–∏–∫–∞ –≤ UI | **100x** |
| –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–∞—Ä—ã | –ú–∏–≥—Ä–∞—Ü–∏—è | 3 –∫–ª–∏–∫–∞ –≤ UI | **100x** |

---

## ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ì–æ—Ä–æ–¥–∞:
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ UI
- ‚úÖ –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∞–∑–æ–≤–æ–π –Ω–∞—Ü–µ–Ω–∫–∏
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö –Ω–∞—Ü–µ–Ω–æ–∫ –ø–æ –ø–∞—Ä–∞–º
- ‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ –±–æ—Ç–µ

### –¢–æ—Ä–≥–æ–≤—ã–µ –ø–∞—Ä—ã:
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ UI
- ‚úÖ –£–∫–∞–∑–∞–Ω–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –∏ endpoint
- ‚úÖ –ê–≤—Ç–æ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∫—É—Ä—Å–æ–≤
- ‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ
- ‚úÖ –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π —Å–µ–ª–µ–∫—Ç–æ—Ä –Ω–∞ –≤–∫–ª–∞–¥–∫–µ "–¢–µ–∫—É—â–∏–µ –∫—É—Ä—Å—ã"

### –ù–∞—Ü–µ–Ω–∫–∏:
- ‚úÖ –ë–∞–∑–æ–≤–∞—è –¥–ª—è –≥–æ—Ä–æ–¥–∞ (–≤—Å–µ –ø–∞—Ä—ã)
- ‚úÖ –°–ø–µ—Ü–∏—Ñ–∏—á–Ω–∞—è –¥–ª—è –ø–∞—Ä—ã –≤ –≥–æ—Ä–æ–¥–µ
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π fallback
- ‚úÖ –ë—ã—Å—Ç—Ä–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ (–±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏)

### –ö—É—Ä—Å—ã:
- ‚úÖ –ë—ã—Å—Ç—Ä–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ (2 –∑–∞–ø—Ä–æ—Å–∞)
- ‚úÖ –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
- ‚úÖ –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π —Å–ø–∏—Å–æ–∫ –ø–∞—Ä

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∫–æ—Ä–æ—Å—Ç–∏
# –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:8000/admin/rates-management
# –í–∫–ª–∞–¥–∫–∞ "–¢–µ–∫—É—â–∏–µ –∫—É—Ä—Å—ã"
# –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç–µ –ø–∞—Ä—É USDT/RUB ‚Üí BTC/USDT
# –î–æ–ª–∂–Ω–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å—Å—è –∑–∞ 1-2 —Å–µ–∫—É–Ω–¥—ã!

# 2. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≥–æ—Ä–æ–¥–∞
# –í–∫–ª–∞–¥–∫–∞ "–ì–æ—Ä–æ–¥—Å–∫–∏–µ –Ω–∞—Ü–µ–Ω–∫–∏" ‚Üí "–î–æ–±–∞–≤–∏—Ç—å –≥–æ—Ä–æ–¥"
# –ö–æ–¥: sochi, –ù–∞–∑–≤–∞–Ω–∏–µ: –°–æ—á–∏, –ù–∞—Ü–µ–Ω–∫–∞: 1.2%
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ –±–æ—Ç–µ: "üí± –ö—É—Ä—Å—ã" ‚Üí —É–≤–∏–¥–∏—Ç–µ "üèñ –°–æ—á–∏"

# 3. –°–ø–µ—Ü–∏—Ñ–∏—á–Ω–∞—è –Ω–∞—Ü–µ–Ω–∫–∞
# –í–∫–ª–∞–¥–∫–∞ "–ì–æ—Ä–æ–¥—Å–∫–∏–µ –Ω–∞—Ü–µ–Ω–∫–∏" ‚Üí –ú–æ—Å–∫–≤–∞ ‚Üí "–ü–æ –ø–∞—Ä–∞–º"
# BTC/USDT: —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ 0.5%
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ: BTC/USDT –≤ –ú–æ—Å–∫–≤–µ –±—É–¥–µ—Ç +0.5%, –∞ USDT/RUB - 0%

# 4. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–∞—Ä—ã
# –í–∫–ª–∞–¥–∫–∞ "–¢–æ—Ä–≥–æ–≤—ã–µ –ø–∞—Ä—ã" ‚Üí "–î–æ–±–∞–≤–∏—Ç—å –ø–∞—Ä—É"
# ETH/USDT –∏–∑ Rapira
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ —Å–µ–ª–µ–∫—Ç–æ—Ä–µ –ø–∞—Ä - –ø–æ—è–≤–∏—Ç—Å—è ETH/USDT
```

---

## üìä SQL –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

```sql
-- –í—Å–µ –≥–æ—Ä–æ–¥–∞
SELECT code, name, markup_percent FROM cities ORDER BY sort_order;

-- –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –Ω–∞—Ü–µ–Ω–∫–∏
SELECT 
    c.name as city,
    cpm.pair_symbol,
    cpm.markup_percent as specific,
    c.markup_percent as base
FROM city_pair_markups cpm
JOIN cities c ON c.id = cpm.city_id
ORDER BY c.name, cpm.pair_symbol;

-- –í—Å–µ –ø–∞—Ä—ã
SELECT internal_symbol, COUNT(*) as sources
FROM fx_source_pair
GROUP BY internal_symbol;
```

---

## üéâ –ò—Ç–æ–≥

**–°–æ–∑–¥–∞–Ω–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è —Å–∏—Å—Ç–µ–º–∞:**
- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≥–æ—Ä–æ–¥–∞–º–∏ —á–µ—Ä–µ–∑ UI
- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ—Ä–≥–æ–≤—ã–º–∏ –ø–∞—Ä–∞–º–∏ —á–µ—Ä–µ–∑ UI
- ‚úÖ –¢—Ä—ë—Ö—É—Ä–æ–≤–Ω–µ–≤—ã–µ –Ω–∞—Ü–µ–Ω–∫–∏ (–±–∞–∑–æ–≤–∞—è + —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–∞—è)
- ‚úÖ –ë—ã—Å—Ç—Ä–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ (–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤)
- ‚úÖ –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π —Å–µ–ª–µ–∫—Ç–æ—Ä –ø–∞—Ä
- ‚úÖ –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤ –±–æ—Ç–µ –±–µ–∑ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞
- ‚úÖ –û–¥–∏–Ω –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –≤—Å–µ–≥–æ

**–í—Å—ë –≥–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é! üöÄ**

---

## üì± –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–µ–π—á–∞—Å

1. **–û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É** (Ctrl+F5)
2. **–í–∫–ª–∞–¥–∫–∞ "–¢–µ–∫—É—â–∏–µ –∫—É—Ä—Å—ã"** - —Å–µ–ª–µ–∫—Ç–æ—Ä –ø–∞—Ä –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
3. **–í–∫–ª–∞–¥–∫–∞ "–ì–æ—Ä–æ–¥—Å–∫–∏–µ –Ω–∞—Ü–µ–Ω–∫–∏"** - —É–≤–∏–¥–∏—Ç–µ –∫–Ω–æ–ø–∫—É "–ü–æ –ø–∞—Ä–∞–º" —É –∫–∞–∂–¥–æ–≥–æ –≥–æ—Ä–æ–¥–∞
4. **–ü–æ–ø—Ä–æ–±—É–π—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å** —Ä–∞–∑–Ω—É—é –Ω–∞—Ü–µ–Ω–∫—É –¥–ª—è BTC/USDT –≤ –ú–æ—Å–∫–≤–µ (0.5%) –∏ –†–æ—Å—Ç–æ–≤–µ (1.5%)
5. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç** –Ω–∞ –≤–∫–ª–∞–¥–∫–µ "–¢–µ–∫—É—â–∏–µ –∫—É—Ä—Å—ã"

**–í—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∏ –±—ã—Å—Ç—Ä–æ! üéâ**

