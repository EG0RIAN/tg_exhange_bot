# ‚úÖ READY TO USE - –ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

## üéâ –í—Å–µ —Å–∏—Å—Ç–µ–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç!

```
Docker Containers: ‚úÖ All Up
‚úÖ PostgreSQL - Running (port 5432)
‚úÖ Redis - Running (port 6379)
‚úÖ Bot - Running
‚úÖ WebAdmin - Running (port 8000)

Database: ‚úÖ Migrations Applied
‚úÖ 004_fx_rates_system.sql
‚úÖ 005_city_markups.sql

FX System: ‚úÖ Active
‚úÖ 2 sources (Grinex, Rapira)
‚úÖ 4 pairs configured
‚úÖ 8 markup rules (7 cities + 1 global)
‚úÖ Auto-sync every 60s

API Status: ‚úÖ All Working
‚úÖ Rapira: best_ask=81.81 ‚ÇΩ, best_bid=81.78 ‚ÇΩ
‚ö†Ô∏è Grinex: API unavailable (404) - not critical
‚úÖ City Rates API: Working
```

## üéØ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –î–ª—è –∫–ª–∏–µ–Ω—Ç–∞ (Telegram Bot)

#### 1. –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∫—É—Ä—Å—ã
```
üí± –ö—É—Ä—Å—ã
  ‚Üì
üåç –í—ã–±–µ—Ä–∏—Ç–µ –≥–æ—Ä–æ–¥
  [–ú–æ—Å–∫–≤–∞] [–°–ü–±] [–†–æ—Å—Ç–æ–≤] [–ù.–ù–æ–≤–≥–æ—Ä–æ–¥] ...
  ‚Üì
üí± –ö—É—Ä—Å—ã –¥–ª—è –≥–æ—Ä–æ–¥–∞: –†–æ—Å—Ç–æ–≤-–Ω–∞-–î–æ–Ω—É

USDT/RUB:
  –ü–æ–∫—É–ø–∫–∞: 82.63 ‚ÇΩ
  –ü—Ä–æ–¥–∞–∂–∞: 82.57 ‚ÇΩ
  –ò—Å—Ç–æ—á–Ω–∏–∫: RAPIRA
  –ù–∞—Ü–µ–Ω–∫–∞ –≥–æ—Ä–æ–¥–∞: +1%

‚úÖ –õ—É—á—à–∏–π –∫—É—Ä—Å –∏–∑ Rapira + Grinex
‚úÖ –° —É—á–µ—Ç–æ–º –Ω–∞—Ü–µ–Ω–∫–∏ –≥–æ—Ä–æ–¥–∞
```

#### 2. –°–æ–∑–¥–∞—Ç—å –∑–∞—è–≤–∫—É
```
‚úâÔ∏è –û—Å—Ç–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É
  ‚Üì
üåç –í—ã–±–µ—Ä–∏—Ç–µ –≥–æ—Ä–æ–¥
  [–†–æ—Å—Ç–æ–≤]
  ‚Üì
‚úÖ –ì–æ—Ä–æ–¥: –†–æ—Å—Ç–æ–≤
–í—ã–±–µ—Ä–∏—Ç–µ –ø–∞—Ä—É:
  [USDT/RUB]
  ‚Üì
‚úÖ –ü–∞—Ä–∞: USDT/RUB
üí∞ –í–∞—à –∫—É—Ä—Å: 82.63 ‚ÇΩ
  ‚îî –ë–∞–∑–æ–≤—ã–π: 81.81 ‚ÇΩ
  ‚îî –ù–∞—Ü–µ–Ω–∫–∞: +1%
  ‚îî –ò—Å—Ç–æ—á–Ω–∏–∫: RAPIRA

–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É...
[–¥–∞–ª–µ–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π flow]
```

### –î–ª—è –∞–¥–º–∏–Ω–∞ (Web Admin)

#### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞—Ü–µ–Ω–∫–∞–º–∏ –≥–æ—Ä–æ–¥–æ–≤

**URL:** http://localhost:8000/admin/city-rates

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –≥–æ—Ä–æ–¥–æ–≤ —Å –Ω–∞—Ü–µ–Ω–∫–∞–º–∏
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ –Ω–∞—Ü–µ–Ω–∫–∏ –≤ 1 –∫–ª–∏–∫
- –ü—Ä–æ—Å–º–æ—Ç—Ä —Ç–µ–∫—É—â–∏—Ö –∫—É—Ä—Å–æ–≤ –ø–æ –≥–æ—Ä–æ–¥–∞–º
- –ë–∞–∑–æ–≤—ã–π –∫—É—Ä—Å Rapira (Ask/Bid/Spread)

**–ü—Ä–∏–º–µ—Ä:**
```
1. –û—Ç–∫—Ä—ã–≤–∞–µ—Ç–µ /admin/city-rates
2. –í–∏–¥–∏—Ç–µ —Ç–∞–±–ª–∏—Ü—É:
   –†–æ—Å—Ç–æ–≤ | +1% | [–ò–∑–º–µ–Ω–∏—Ç—å]
3. –ù–∞–∂–∏–º–∞–µ—Ç–µ "–ò–∑–º–µ–Ω–∏—Ç—å"
4. –í–≤–æ–¥–∏—Ç–µ 1.2
5. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç–µ
6. –¢–µ–ø–µ—Ä—å –†–æ—Å—Ç–æ–≤: +1.2% (–±—ã–ª–æ +1%)
```

#### Markup Rules (–¥–µ—Ç–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞)

**URL:** http://localhost:8000/admin/fx/markup-rules

**–ö–æ–≥–¥–∞ –Ω—É–∂–Ω–æ:**
- –°–æ–∑–¥–∞—Ç—å –ø—Ä–∞–≤–∏–ª–æ –¥–ª—è –Ω–æ–≤–æ–≥–æ –≥–æ—Ä–æ–¥–∞
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–∞–≤–∏–ª–æ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –ø–∞—Ä—ã
- –í—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å –Ω–∞—Ü–µ–Ω–∫—É
- –ó–∞–¥–∞—Ç—å –ø–µ—Ä–∏–æ–¥ –¥–µ–π—Å—Ç–≤–∏—è –ø—Ä–∞–≤–∏–ª–∞

#### –ü—Ä–æ—Å–º–æ—Ç—Ä –∑–∞—è–≤–æ–∫

**URL:** http://localhost:8000/admin/orders

**–ß—Ç–æ –≤–∏–¥–Ω–æ:**
- –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
- **+ –ì–æ—Ä–æ–¥ –∫–ª–∏–µ–Ω—Ç–∞** (–∏–∑ rate_snapshot)
- **+ –ö—É—Ä—Å –Ω–∞ –º–æ–º–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω–∏—è**
- **+ –ò—Å—Ç–æ—á–Ω–∏–∫ –∫—É—Ä—Å–∞** (Rapira/Grinex)

## üåç –ì–æ—Ä–æ–¥–∞ –∏ –Ω–∞—Ü–µ–Ω–∫–∏

| –ì–æ—Ä–æ–¥ | –ö–æ–¥ | –ù–∞—Ü–µ–Ω–∫–∞ | –ü—Ä–∏–º–µ—Ä (–æ—Ç 81.81 ‚ÇΩ) |
|-------|-----|---------|---------------------|
| –ú–æ—Å–∫–≤–∞ | moscow | 0% | 81.81 ‚ÇΩ |
| –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥ | spb | +0.3% | 82.06 ‚ÇΩ |
| –ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥ | ekaterinburg | +0.7% | 82.38 ‚ÇΩ |
| –ù–∏–∂–Ω–∏–π –ù–æ–≤–≥–æ—Ä–æ–¥ | nizhniy_novgorod | +0.8% | 82.46 ‚ÇΩ |
| –ö–∞–∑–∞–Ω—å | kazan | +0.9% | 82.55 ‚ÇΩ |
| –†–æ—Å—Ç–æ–≤-–Ω–∞-–î–æ–Ω—É | rostov | +1.0% | 82.63 ‚ÇΩ |
| –î—Ä—É–≥–∏–µ –≥–æ—Ä–æ–¥–∞ | other | +1.5% | 83.04 ‚ÇΩ |

## üìä –õ–æ–≥–∏–∫–∞ –≤—ã–±–æ—Ä–∞ –∫—É—Ä—Å–∞

### –î–ª—è operation="buy" (–∫–ª–∏–µ–Ω—Ç –ø–æ–∫—É–ø–∞–µ—Ç USDT)

```python
1. Rapira: 81.81 ‚ÇΩ
2. Grinex: 81.90 ‚ÇΩ (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω)
   
   ‚Üí –í—ã–±–∏—Ä–∞–µ–º: min(81.81, 81.90) = 81.81 ‚ÇΩ (Rapira –ª—É—á—à–µ)
   
3. –ì–æ—Ä–æ–¥ –†–æ—Å—Ç–æ–≤: +1%
   
   ‚Üí –§–∏–Ω–∞–ª—å–Ω—ã–π: 81.81 √ó 1.01 = 82.63 ‚ÇΩ
```

### –î–ª—è operation="sell" (–∫–ª–∏–µ–Ω—Ç –ø—Ä–æ–¥–∞–µ—Ç USDT)

```python
1. Rapira: 81.78 ‚ÇΩ
2. Grinex: 81.75 ‚ÇΩ (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω)
   
   ‚Üí –í—ã–±–∏—Ä–∞–µ–º: max(81.78, 81.75) = 81.78 ‚ÇΩ (Rapira –ª—É—á—à–µ)
   
3. –ì–æ—Ä–æ–¥ –†–æ—Å—Ç–æ–≤: +1%
   
   ‚Üí –§–∏–Ω–∞–ª—å–Ω—ã–π: 81.78 √ó 1.01 = 82.60 ‚ÇΩ
```

## üîß API –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### –ë–∞–∑–æ–≤—ã–π –∫—É—Ä—Å Rapira
```bash
curl "http://localhost:8000/api/test/rapira-base-rate?symbol=USDT/RUB"
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "success": true,
  "symbol": "USDT/RUB",
  "best_ask": 81.81,
  "best_bid": 81.78,
  "timestamp": "2025-10-14T02:48:00"
}
```

### –ö—É—Ä—Å—ã –≤—Å–µ—Ö –≥–æ—Ä–æ–¥–æ–≤
```bash
# –¢—Ä–µ–±—É–µ—Ç login –≤ –∞–¥–º–∏–Ω–∫—É
GET /api/city-rates/all?symbol=USDT/RUB&operation=buy
```

### –ö—É—Ä—Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –≥–æ—Ä–æ–¥–∞
```bash
# –¢—Ä–µ–±—É–µ—Ç login
GET /api/city-rate/rostov?symbol=USDT/RUB&operation=buy
```

## üì± –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å –≤ –±–æ—Ç–µ

### –î–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤

**–ë—ã–ª–æ:**
```
üí± –ö—É—Ä—Å—ã
  ‚Üí –í—ã–±–æ—Ä –ø–∞—Ä—ã
  ‚Üí –ö—É—Ä—Å—ã –∏–∑ —Å—Ç–∞—Ä–æ–π —Ç–∞–±–ª–∏—Ü—ã rate_tiers
```

**–°—Ç–∞–ª–æ:**
```
üí± –ö—É—Ä—Å—ã
  ‚Üí –í—ã–±–æ—Ä –≥–æ—Ä–æ–¥–∞ ‚Üê –ù–û–í–û–ï!
  ‚Üí –ö—É—Ä—Å—ã —Å –Ω–∞—Ü–µ–Ω–∫–æ–π –≥–æ—Ä–æ–¥–∞
  ‚Üí –õ—É—á—à–∏–π –∫—É—Ä—Å –∏–∑ Rapira + Grinex
```

**–ë—ã–ª–æ:**
```
‚úâÔ∏è –û—Å—Ç–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É
  ‚Üí –í—ã–±–æ—Ä –ø–∞—Ä—ã
  ‚Üí –°—É–º–º–∞
  ‚Üí ...
```

**–°—Ç–∞–ª–æ:**
```
‚úâÔ∏è –û—Å—Ç–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É
  ‚Üí –í—ã–±–æ—Ä –≥–æ—Ä–æ–¥–∞ ‚Üê –ù–û–í–û–ï!
  ‚Üí –í—ã–±–æ—Ä –ø–∞—Ä—ã (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∫—É—Ä—Å –≥–æ—Ä–æ–¥–∞)
  ‚Üí –°—É–º–º–∞
  ‚Üí ...
```

### –î–ª—è –∞–¥–º–∏–Ω–æ–≤

**–£–¥–∞–ª–µ–Ω–æ:**
- ‚ùå `/rapira_status` - —Å—Ç–∞—Ä–∞—è –ø–∞–Ω–µ–ª—å Rapira
- ‚ùå `/rapira_vwap` - VWAP —Ä–∞—Å—á–µ—Ç—ã
- ‚ùå `/rapira` —Å—Ç—Ä–∞–Ω–∏—Ü—ã –≤ Web Admin

**–î–æ–±–∞–≤–ª–µ–Ω–æ:**
- ‚úÖ `/grinex_status` - –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è Grinex
- ‚úÖ `/admin` ‚Üí "üåê –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏" ‚Üí –ú–µ–Ω—é
- ‚úÖ `/admin/city-rates` - –≥–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

**–û—Å—Ç–∞–ª–æ—Å—å:**
- ‚úÖ –í—Å–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –∞–¥–º–∏–Ω-—Ñ—É–Ω–∫—Ü–∏–∏
- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º
- ‚úÖ –ó–∞—è–≤–∫–∏, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, —á–∞—Ç—ã –∏ —Ç.–¥.

## üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### –ó–∞—è–≤–∫–∏ —Ç–µ–ø–µ—Ä—å —Å–æ–¥–µ—Ä–∂–∞—Ç

**–¢–∞–±–ª–∏—Ü–∞ `orders`, –ø–æ–ª–µ `rate_snapshot`:**
```json
{
  "city": "rostov",
  "city_name": "–†–æ—Å—Ç–æ–≤-–Ω–∞-–î–æ–Ω—É",
  "rate": 82.63,
  "rate_source": "rapira",
  "timestamp": "2025-10-14T02:48:00"
}
```

–≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç:
- –í–∏–¥–µ—Ç—å –ø–æ –∫–∞–∫–æ–º—É –∫—É—Ä—Å—É —Å–æ–∑–¥–∞–Ω–∞ –∑–∞—è–≤–∫–∞
- –ó–Ω–∞—Ç—å –≥–æ—Ä–æ–¥ –∫–ª–∏–µ–Ω—Ç–∞
- –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫ –ª—É—á—à–µ–≥–æ –∫—É—Ä—Å–∞
- –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø–æ –≥–æ—Ä–æ–¥–∞–º

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –Ω–∞—Ü–µ–Ω–æ–∫

### –ß–µ—Ä–µ–∑ Web Admin (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
```
http://localhost:8000/admin/city-rates
‚Üí –¢–∞–±–ª–∏—Ü–∞ —Å –Ω–∞—Ü–µ–Ω–∫–∞–º–∏
‚Üí [–ò–∑–º–µ–Ω–∏—Ç—å] ‚Üí –ù–æ–≤—ã–π –ø—Ä–æ—Ü–µ–Ω—Ç ‚Üí –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
```

### –ß–µ—Ä–µ–∑ SQL
```sql
-- –ò–∑–º–µ–Ω–∏—Ç—å –Ω–∞—Ü–µ–Ω–∫—É –†–æ—Å—Ç–æ–≤–∞
UPDATE fx_markup_rule
SET percent = 1.2
WHERE description ILIKE '%–≥–æ—Ä–æ–¥: rostov%';

-- –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π –≥–æ—Ä–æ–¥
INSERT INTO fx_markup_rule (level, percent, fixed, enabled, description, rounding_mode, round_to)
VALUES ('global', 1.1, 0, true, '–ù–∞—Ü–µ–Ω–∫–∞ –¥–ª—è –≥–æ—Ä–æ–¥–∞: krasnodar (–ö—Ä–∞—Å–Ω–æ–¥–∞—Ä)', 'ROUND_HALF_UP', 2);
```

## üéØ –ë—ã—Å—Ç—Ä—ã–µ —Å—Å—ã–ª–∫–∏

| –†–∞–∑–¥–µ–ª | URL |
|--------|-----|
| –ì–ª–∞–≤–Ω–∞—è –∞–¥–º–∏–Ω–∫–∞ | http://localhost:8000/admin |
| **–ö—É—Ä—Å—ã –ø–æ –≥–æ—Ä–æ–¥–∞–º** | http://localhost:8000/admin/city-rates |
| Markup Rules | http://localhost:8000/admin/fx/markup-rules |
| FX Sources | http://localhost:8000/admin/fx/sources |
| –ó–∞—è–≤–∫–∏ | http://localhost:8000/admin/orders |
| –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ | http://localhost:8000/admin/users |

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

| –§–∞–π–ª | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|----------|
| `CLIENT_FLOW_UPDATE.md` | –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤ |
| `CITY_RATES_README.md` | –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∫—É—Ä—Å–∞–º –≥–æ—Ä–æ–¥–æ–≤ |
| `CITY_RATES_QUICKSTART.md` | –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç |
| `RAPIRA_STATUS_REMOVED.md` | –ß—Ç–æ —É–¥–∞–ª–µ–Ω–æ |
| `FINAL_SUMMARY.md` | –ò—Ç–æ–≥–æ–≤–æ–µ —Ä–µ–∑—é–º–µ |
| `READY_TO_USE.md` | –≠—Ç–æ—Ç —Ñ–∞–π–ª |

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏

### Backend
- [x] –ú–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã
- [x] FX –º–æ–¥—É–ª—å —Ä–∞–±–æ—Ç–∞–µ—Ç
- [x] Rapira API –¥–æ—Å—Ç—É–ø–µ–Ω
- [x] City markups —Å–æ–∑–¥–∞–Ω—ã
- [x] Best rate –ª–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç

### Bot
- [x] FSM –æ–±–Ω–æ–≤–ª–µ–Ω (–¥–æ–±–∞–≤–ª–µ–Ω –≤—ã–±–æ—Ä –≥–æ—Ä–æ–¥–∞)
- [x] –ö–Ω–æ–ø–∫–∞ "üí± –ö—É—Ä—Å—ã" ‚Üí –≤—ã–±–æ—Ä –≥–æ—Ä–æ–¥–∞
- [x] –ö–Ω–æ–ø–∫–∞ "‚úâÔ∏è –ó–∞—è–≤–∫–∞" ‚Üí –≤—ã–±–æ—Ä –≥–æ—Ä–æ–¥–∞
- [x] –ü–æ–∫–∞–∑ –∫—É—Ä—Å–æ–≤ —Å –Ω–∞—Ü–µ–Ω–∫–æ–π –≥–æ—Ä–æ–¥–∞
- [x] –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≥–æ—Ä–æ–¥–∞ –≤ –∑–∞—è–≤–∫–µ

### Web Admin
- [x] –î–∞—à–±–æ—Ä–¥ –æ–±–Ω–æ–≤–ª–µ–Ω
- [x] City Rates —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç
- [x] API endpoints –æ—Ç–≤–µ—á–∞—é—Ç
- [x] –ë–∞–∑–æ–≤—ã–π –∫—É—Ä—Å Rapira –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è
- [x] –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞—Ü–µ–Ω–æ–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –£–¥–∞–ª–µ–Ω–æ
- [x] admin_rapira.py handler
- [x] –°—Ç–∞—Ä—ã–µ Rapira –º–∞—Ä—à—Ä—É—Ç—ã
- [x] –ö–∞—Ä—Ç–æ—á–∫–∞ Rapira –∏–∑ –¥–∞—à–±–æ—Ä–¥–∞
- [x] –ö–Ω–æ–ø–∫–∞ Rapira –∏–∑ –º–µ–Ω—é

## üöÄ –ù–∞—á–Ω–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### 1. –í Telegram –±–æ—Ç–µ

–ù–∞–∂–º–∏—Ç–µ **"üí± –ö—É—Ä—Å—ã"** –∏–ª–∏ **"‚úâÔ∏è –û—Å—Ç–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É"**

–í—ã —É–≤–∏–¥–∏—Ç–µ –≤—ã–±–æ—Ä –≥–æ—Ä–æ–¥–∞ –∫–∞–∫ –ø–µ—Ä–≤—ã–π —à–∞–≥!

### 2. –í Web Admin

–û—Ç–∫—Ä–æ–π—Ç–µ **http://localhost:8000/admin/city-rates**

–í—ã —É–≤–∏–¥–∏—Ç–µ:
- –¢–∞–±–ª–∏—Ü—É –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–∞—Ü–µ–Ω–æ–∫
- –ö–∞—Ä—Ç–æ—á–∫–∏ —Å –∫—É—Ä—Å–∞–º–∏ –ø–æ –≥–æ—Ä–æ–¥–∞–º
- –ë–∞–∑–æ–≤—ã–π –∫—É—Ä—Å –∏–∑ Rapira

### 3. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ

```bash
# –ë–∞–∑–æ–≤—ã–π –∫—É—Ä—Å
curl "http://localhost:8000/api/test/rapira-base-rate?symbol=USDT/RUB"
# ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç: 81.81 ‚ÇΩ

# –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose ps
# ‚úÖ –í—Å–µ Up
```

## üí° –û—Å–Ω–æ–≤–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ö–ª–∏–µ–Ω—Ç —Å–º–æ—Ç—Ä–∏—Ç –∫—É—Ä—Å—ã

1. –û—Ç–∫—Ä—ã–≤–∞–µ—Ç –±–æ—Ç
2. –ù–∞–∂–∏–º–∞–µ—Ç "üí± –ö—É—Ä—Å—ã"
3. –í—ã–±–∏—Ä–∞–µ—Ç —Å–≤–æ–π –≥–æ—Ä–æ–¥ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –†–æ—Å—Ç–æ–≤)
4. –í–∏–¥–∏—Ç –∫—É—Ä—Å—ã —Å –Ω–∞—Ü–µ–Ω–∫–æ–π: **82.63 ‚ÇΩ** (–≤–º–µ—Å—Ç–æ –±–∞–∑–æ–≤—ã—Ö 81.81 ‚ÇΩ)

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ö–ª–∏–µ–Ω—Ç —Å–æ–∑–¥–∞–µ—Ç –∑–∞—è–≤–∫—É

1. –ù–∞–∂–∏–º–∞–µ—Ç "‚úâÔ∏è –û—Å—Ç–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É"
2. –í—ã–±–∏—Ä–∞–µ—Ç –≥–æ—Ä–æ–¥ (–†–æ—Å—Ç–æ–≤)
3. –í—ã–±–∏—Ä–∞–µ—Ç –ø–∞—Ä—É (USDT/RUB) - **—Å—Ä–∞–∑—É –≤–∏–¥–∏—Ç —Å–≤–æ–π –∫—É—Ä—Å 82.63 ‚ÇΩ**
4. –ó–∞–ø–æ–ª–Ω—è–µ—Ç –æ—Å—Ç–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
5. –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç - –∑–∞—è–≤–∫–∞ —Å–æ–∑–¥–∞–µ—Ç—Å—è —Å –∫—É—Ä—Å–æ–º 82.63 ‚ÇΩ –∏ –≥–æ—Ä–æ–¥–æ–º

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –ê–¥–º–∏–Ω –º–µ–Ω—è–µ—Ç –Ω–∞—Ü–µ–Ω–∫—É

1. –û—Ç–∫—Ä—ã–≤–∞–µ—Ç http://localhost:8000/admin/city-rates
2. –í–∏–¥–∏—Ç "–†–æ—Å—Ç–æ–≤ | +1%"
3. –ù–∞–∂–∏–º–∞–µ—Ç "–ò–∑–º–µ–Ω–∏—Ç—å"
4. –í–≤–æ–¥–∏—Ç 1.2 (–Ω–æ–≤–∞—è –Ω–∞—Ü–µ–Ω–∫–∞)
5. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç
6. –¢–µ–ø–µ—Ä—å –∫–ª–∏–µ–Ω—Ç—ã –∏–∑ –†–æ—Å—Ç–æ–≤–∞ –≤–∏–¥—è—Ç 82.79 ‚ÇΩ (–≤–º–µ—Å—Ç–æ 82.63 ‚ÇΩ)

## üé® –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                 Telegram Bot                      ‚îÇ
‚îÇ  –ö–ª–∏–µ–Ω—Ç ‚Üí "üí± –ö—É—Ä—Å—ã" –∏–ª–∏ "‚úâÔ∏è –ó–∞—è–≤–∫–∞"            ‚îÇ
‚îÇ                     ‚Üì                             ‚îÇ
‚îÇ           üåç –í—ã–±–æ—Ä –≥–æ—Ä–æ–¥–∞                        ‚îÇ
‚îÇ                     ‚Üì                             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                      ‚îÇ
        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
        ‚îÇ                           ‚îÇ
    ‚îå‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îê                 ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ Rapira ‚îÇ                 ‚îÇ Grinex  ‚îÇ
    ‚îÇ 81.81‚ÇΩ ‚îÇ                 ‚îÇ 81.90‚ÇΩ  ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îò                 ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îò
        ‚îÇ                           ‚îÇ
        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                   ‚îÇ
         –õ—É—á—à–∏–π: 81.81‚ÇΩ (Rapira)
                   ‚îÇ
                   ‚ñº
         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
         ‚îÇ Markup Rules    ‚îÇ
         ‚îÇ –†–æ—Å—Ç–æ–≤: +1%     ‚îÇ
         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                  ‚îÇ
         Final: 82.63‚ÇΩ
                  ‚îÇ
                  ‚ñº
         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
         ‚îÇ   –ö–ª–∏–µ–Ω—Ç—É       ‚îÇ
         ‚îÇ   82.63 ‚ÇΩ       ‚îÇ
         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## üìä –ß—Ç–æ –æ—Å—Ç–∞–ª–æ—Å—å –≤ –∞–¥–º–∏–Ω–∫–µ

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Ä–∞–∑–¥–µ–ª—ã
1. **–ö—É—Ä—Å—ã –ø–æ –≥–æ—Ä–æ–¥–∞–º** (`/admin/city-rates`) ‚≠ê
   - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞—Ü–µ–Ω–∫–∞–º–∏
   - –ü—Ä–æ—Å–º–æ—Ç—Ä —Ç–µ–∫—É—â–∏—Ö –∫—É—Ä—Å–æ–≤
   - –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

2. **Markup Rules** (`/admin/fx/markup-rules`)
   - –î–µ—Ç–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∞–≤–∏–ª
   - CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏

3. **–ó–∞—è–≤–∫–∏** (`/admin/orders`)
   - –ü—Ä–æ—Å–º–æ—Ç—Ä —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –≥–æ—Ä–æ–¥–µ
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞—è–≤–æ–∫

4. **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏** (`/admin/users`)
5. **Live —á–∞—Ç—ã** (`/admin/live-chats`)
6. **FAQ** (`/admin/faq`)
7. **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** (`/admin/notifications`)

### –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ä–∞–∑–¥–µ–ª—ã
- FX Sources (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ —É–ø—Ä–∞–≤–ª—è—Ç—å Grinex)
- FX Rates (–ø—Ä–æ—Å–º–æ—Ç—Ä raw –¥–∞–Ω–Ω—ã—Ö)
- FX Logs (–ª–æ–≥–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏)

## üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

### –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç
- ‚úÖ FX Scheduler - –æ–±–Ω–æ–≤–ª—è–µ—Ç –∫—É—Ä—Å—ã –∫–∞–∂–¥—ã–µ 60 —Å–µ–∫
- ‚úÖ Legacy Scheduler - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Å—Ç–∞—Ä—ã—Ö –∫—É—Ä—Å–æ–≤
- ‚úÖ Rapira Scheduler - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ Rapira

### –ò—Å—Ç–æ—á–Ω–∏–∫–∏
- ‚úÖ Rapira: —Ä–∞–±–æ—Ç–∞–µ—Ç (81.81 ‚ÇΩ)
- ‚ö†Ô∏è Grinex: API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω (–º–æ–∂–Ω–æ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å, Rapira –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ)

## ‚ö†Ô∏è Known Issues

### 1. Grinex API 404
```
Grinex API retry 3/3: 404 Not Found
```
**–†–µ—à–µ–Ω–∏–µ:** –ù–µ –∫—Ä–∏—Ç–∏—á–Ω–æ. Rapira —Ä–∞–±–æ—Ç–∞–µ—Ç, —ç—Ç–æ–≥–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ. –ï—Å–ª–∏ –Ω—É–∂–µ–Ω Grinex - —É—Ç–æ—á–Ω–∏—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π API URL.

### 2. Telegram Conflict
```
Conflict: terminated by other getUpdates request
```
**–†–µ—à–µ–Ω–∏–µ:** –ì–¥–µ-—Ç–æ –µ—â–µ –∑–∞–ø—É—â–µ–Ω –±–æ—Ç. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –¥—Ä—É–≥–æ–π —ç–∫–∑–µ–º–ø–ª—è—Ä –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω –¥–ª—è dev.

## ‚ú® –ì–æ—Ç–æ–≤–æ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É!

### –ö–ª–∏–µ–Ω—Ç—Å–∫–∞—è —á–∞—Å—Ç—å
- ‚úÖ –í—ã–±–æ—Ä –≥–æ—Ä–æ–¥–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –ö—É—Ä—Å—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è —Å –Ω–∞—Ü–µ–Ω–∫–æ–π
- ‚úÖ –ó–∞—è–≤–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –≥–æ—Ä–æ–¥–µ
- ‚úÖ –õ—É—á—à–∏–π –∫—É—Ä—Å –∏–∑ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤

### –ê–¥–º–∏–Ω–∫–∞
- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞—Ü–µ–Ω–∫–∞–º–∏ –≤ 1 –∫–ª–∏–∫
- ‚úÖ –ü—Ä–æ—Å–º–æ—Ç—Ä –∫—É—Ä—Å–æ–≤ –ø–æ –≥–æ—Ä–æ–¥–∞–º
- ‚úÖ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≥–æ—Ä–æ–¥–µ –≤ –∑–∞—è–≤–∫–∞—Ö
- ‚úÖ –ü—Ä–æ—Å—Ç–æ–π –∏ –ø–æ–Ω—è—Ç–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

### –°–∏—Å—Ç–µ–º–Ω–æ–µ
- ‚úÖ –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫—É—Ä—Å–æ–≤
- ‚úÖ Fallback –º–µ—Ö–∞–Ω–∏–∑–º—ã
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ Docker ready

---

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –≤ –±–æ—Ç–µ:**
   - –ù–∞–∂–º–∏—Ç–µ "üí± –ö—É—Ä—Å—ã" ‚Üí –í—ã–±–µ—Ä–∏—Ç–µ –≥–æ—Ä–æ–¥
   - –°–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—É—é –∑–∞—è–≤–∫—É ‚Üí –í—ã–±–µ—Ä–∏—Ç–µ –≥–æ—Ä–æ–¥

2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –Ω–∞—Ü–µ–Ω–∫–∏:**
   - http://localhost:8000/admin/city-rates
   - –ò–∑–º–µ–Ω–∏—Ç–µ –Ω–∞—Ü–µ–Ω–∫—É –ª—é–±–æ–≥–æ –≥–æ—Ä–æ–¥–∞
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –∫—É—Ä—Å—ã –ø–µ—Ä–µ—Å—á–∏—Ç–∞–ª–∏—Å—å

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∑–∞—è–≤–∫–∏:**
   - http://localhost:8000/admin/orders
   - –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ —á—Ç–æ –≤ rate_snapshot —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≥–æ—Ä–æ–¥

**–í—Å—ë –≥–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!** üöÄüéâ

