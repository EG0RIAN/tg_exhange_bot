# –†–µ–∑—é–º–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å Rapira API

## ‚úÖ –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### 1. –û—Å–Ω–æ–≤–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- **RapiraProvider** - –æ—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ–≤–∞–π–¥–µ—Ä –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å API
- **RatesCalculator** - –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –∫—É—Ä—Å–æ–≤ —Å –±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞–º–∏
- **RatesScheduler** - –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- **Admin Handlers** - –∞–¥–º–∏–Ω—Å–∫–∏–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 2. –ö–ª—é—á–µ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- ‚úÖ **Plate Mini API** - –ø–æ–ª—É—á–µ–Ω–∏–µ –º–∏–Ω–∏-—Å—Ç–∞–∫–∞–Ω–∞ –∏ –≥–ª—É–±–∏–Ω—ã
- ‚úÖ **VWAP —Ä–∞—Å—á–µ—Ç—ã** - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –±–æ–ª—å—à–∏—Ö —Å—É–º–º ($50k+)
- ‚úÖ **–ë–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞** - —Å–ø—Ä–µ–¥—ã –ø–æ –≥–æ—Ä–æ–¥–∞–º, –ø—Ä–æ—Ü–µ–Ω—Ç–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞
- ‚úÖ **Fallback —Å—Ç—Ä–∞—Ç–µ–≥–∏—è** - –∫—ç—à ‚Üí rates API ‚Üí –ë–î ‚Üí –¥–µ—Ñ–æ–ª—Ç
- ‚úÖ **Health monitoring** - –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ—Å—Ç–æ—è–Ω–∏—è API
- ‚úÖ **Retry –ª–æ–≥–∏–∫–∞** - —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –ø–∞—É–∑–∞ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

### 3. –ê–¥–º–∏–Ω—Å–∫–∏–µ –∫–æ–º–∞–Ω–¥—ã
- `/rapira_status` - –ø–æ–ª–Ω—ã–π —Å—Ç–∞—Ç—É—Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
- `/rapira_vwap` - –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Ä–∞—Å—á–µ—Ç VWAP
- `/rapira_help` - —Å–ø—Ä–∞–≤–∫–∞ –ø–æ –∫–æ–º–∞–Ω–¥–∞–º
- –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è: –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ, –¥–µ—Ç–∞–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏, —Ç–µ—Å—Ç API

### 4. –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏
- **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ**: Redis —Å TTL 5 —Å–µ–∫—É–Ω–¥
- **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å —Ä–∞–∑–Ω—ã–º–∏ —É—Ä–æ–≤–Ω—è–º–∏
- **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**: –≥–∏–±–∫–∞—è —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- **–¢–µ—Å—Ç—ã**: –ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä unit –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
```bash
RAPIRA_API_BASE=https://api.rapira.net
REDIS_HOST=localhost
REDIS_PORT=6379
ADMIN_IDS=123456789,987654321
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- **Cache TTL**: 5 —Å–µ–∫—É–Ω–¥
- **Update interval**: 5 —Å–µ–∫—É–Ω–¥
- **VWAP amount**: $50,000
- **City spreads**: –ú–æ—Å–∫–≤–∞ 0.5%, –°–ü–± 0.6%, –¥—Ä—É–≥–∏–µ 1.0%

## üöÄ –ó–∞–ø—É—Å–∫

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```bash
pip install -r requirements.txt
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```bash
cp rapira_env_example.txt .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env —Ñ–∞–π–ª
```

### 3. –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
```bash
python -m src.bot
```

### 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã
```
/rapira_status
/rapira_help
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### Health –º–µ—Ç—Ä–∏–∫–∏
- **Latency**: –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ API
- **HTTP –∫–æ–¥**: —Å—Ç–∞—Ç—É—Å –æ—Ç–≤–µ—Ç–∞
- **Freshness**: —Å–≤–µ–∂–µ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö
- **Error count**: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫

### –õ–æ–≥–∏
- **INFO**: —É—Å–ø–µ—à–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
- **WARNING**: retry –ø–æ–ø—ã—Ç–∫–∏
- **ERROR**: –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
```bash
pytest tests/test_rapira_integration.py -v
```

### –ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏
- ‚úÖ RapiraProvider: API –∑–∞–ø—Ä–æ—Å—ã, VWAP, fallback
- ‚úÖ RatesCalculator: –±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞, —Å–ø—Ä–µ–¥—ã
- ‚úÖ RatesScheduler: –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫, —Å—Ç–∞—Ç—É—Å
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã: –ø–æ–ª–Ω—ã–π workflow

## üîÑ Workflow

### 1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
```
–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ (5 —Å–µ–∫) ‚Üí Rapira API ‚Üí –ö—ç—à Redis ‚Üí –ë–î
```

### 2. –†–∞—Å—á–µ—Ç –∫—É—Ä—Å–∞
```
–ó–∞–ø—Ä–æ—Å –∫—É—Ä—Å–∞ ‚Üí –ü–æ–ª—É—á–µ–Ω–∏–µ plate ‚Üí VWAP/Top-of-book ‚Üí –ë–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞ ‚Üí –û–∫—Ä—É–≥–ª–µ–Ω–∏–µ
```

### 3. Fallback —Å—Ç—Ä–∞—Ç–µ–≥–∏—è
```
Plate Mini API ‚Üí Rates API ‚Üí Redis Cache ‚Üí Database ‚Üí Default
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
src/
‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îú‚îÄ‚îÄ rapira.py              # –û—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ–≤–∞–π–¥–µ—Ä
‚îÇ   ‚îú‚îÄ‚îÄ rates_calculator.py    # –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –∫—É—Ä—Å–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ rates_scheduler.py     # –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫
‚îú‚îÄ‚îÄ handlers/
‚îÇ   ‚îî‚îÄ‚îÄ admin_rapira.py        # –ê–¥–º–∏–Ω—Å–∫–∏–µ –∫–æ–º–∞–Ω–¥—ã
‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îî‚îÄ‚îÄ rapira_config.py       # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îî‚îÄ‚îÄ bot.py                     # –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ä–æ—É—Ç–µ—Ä–∞

tests/
‚îî‚îÄ‚îÄ test_rapira_integration.py # –¢–µ—Å—Ç—ã

docs/
‚îú‚îÄ‚îÄ RAPIRA_INTEGRATION_README.md    # –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îú‚îÄ‚îÄ RAPIRA_IMPLEMENTATION_SUMMARY.md # –≠—Ç–æ —Ä–µ–∑—é–º–µ
‚îî‚îÄ‚îÄ rapira_env_example.txt          # –ü—Ä–∏–º–µ—Ä .env
```

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### 1. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å Rapira API
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–ª–µ—Ä—Ç—ã
- –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å fallback —Å—Ç—Ä–∞—Ç–µ–≥–∏—é

### 2. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- –ê–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–ø—Ä–µ–¥—ã –ø–æ–¥ –±–∏–∑–Ω–µ—Å-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

### 3. –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ
- –î–æ–±–∞–≤–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –∫—É—Ä—Å–æ–≤
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å WebSocket –¥–ª—è real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
- –°–æ–∑–¥–∞—Ç—å –¥–∞—à–±–æ—Ä–¥—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã

1. **API –ª–∏–º–∏—Ç—ã**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ–ø—É—Å—Ç–∏–º—ã–µ –ª–∏–º–∏—Ç—ã Rapira API
2. **–°–µ—Ç–µ–≤–∞—è –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å**: –£–±–µ–¥–∏—Ç–µ—Å—å –≤ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
3. **Redis**: –¢—Ä–µ–±—É–µ—Ç—Å—è —Ä–∞–±–æ—Ç–∞—é—â–∏–π Redis —Å–µ—Ä–≤–µ—Ä
4. **Admin –ø—Ä–∞–≤–∞**: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ ADMIN_IDS –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∞–ª–µ—Ä—Ç–æ–≤

## üÜò –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `/rapira_status`
2. –ò–∑—É—á–∏—Ç–µ –ª–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—ã –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
4. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –≤ `RAPIRA_INTEGRATION_README.md`

---

**–°—Ç–∞—Ç—É—Å**: ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –∏ –≥–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é
**–í–µ—Ä—Å–∏—è**: v1.0
**–î–∞—Ç–∞**: 2024
