<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–ó–∞—è–≤–∫–∞ #{{ order.id }} - –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</title>
    <link rel="stylesheet" href="/static/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container-fluid">
        <a class="navbar-brand" href="/admin">
            <i class="bi bi-shield-check"></i> –ê–¥–º–∏–Ω–∫–∞
        </a>
        <div class="d-flex">
            <span class="navbar-text me-3">
                <i class="bi bi-person-circle"></i> {{ user }}
            </span>
            <a href="/logout" class="btn btn-outline-light">
                <i class="bi bi-box-arrow-right"></i> –í—ã–π—Ç–∏
            </a>
        </div>
    </div>
</nav>

<div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1><i class="bi bi-file-earmark-text"></i> –ó–∞—è–≤–∫–∞ #{{ order.id }}</h1>
        <a href="/admin/orders" class="btn btn-secondary">
            <i class="bi bi-arrow-left"></i> –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É
        </a>
    </div>

    <div class="row">
        <div class="col-md-8">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0">–î–µ—Ç–∞–ª–∏ –∑–∞—è–≤–∫–∏</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <p><strong>ID –∑–∞—è–≤–∫–∏:</strong> {{ order.id }}</p>
                            
                            {% if order.order_type %}
                            <p><strong>–¢–∏–ø –æ–ø–µ—Ä–∞—Ü–∏–∏:</strong> 
                                {% if order.order_type == 'buy_usdt' %}
                                    <span class="badge bg-success">üíµ –ö—É–ø–∏—Ç—å USDT</span>
                                {% elif order.order_type == 'sell_usdt' %}
                                    <span class="badge bg-info">üí∏ –ü—Ä–æ–¥–∞—Ç—å USDT</span>
                                {% elif order.order_type == 'pay_invoice' %}
                                    <span class="badge bg-warning">üìÑ –û–ø–ª–∞—Ç–∏—Ç—å –∏–Ω–≤–æ–π—Å</span>
                                {% else %}
                                    <span class="badge bg-secondary">{{ order.order_type }}</span>
                                {% endif %}
                            </p>
                            {% endif %}
                            
                            {% if order.city %}
                            <p><strong>–ì–æ—Ä–æ–¥:</strong> {{ order.city }}</p>
                            {% endif %}
                            
                            {% if order.currency %}
                            <p><strong>–í–∞–ª—é—Ç–∞ –≤—ã–¥–∞—á–∏:</strong> <span class="badge bg-primary">{{ order.currency }}</span></p>
                            {% endif %}
                            
                            {% if order.pair %}
                            <p><strong>–í–∞–ª—é—Ç–Ω–∞—è –ø–∞—Ä–∞:</strong> 
                                <span class="badge bg-primary">{{ order.pair }}</span>
                            </p>
                            {% endif %}
                            
                            <p><strong>–°—É–º–º–∞:</strong> {{ order.amount }}</p>
                            
                            {% if order.payout_method %}
                            <p><strong>–°–ø–æ—Å–æ–± –≤—ã–ø–ª–∞—Ç—ã:</strong> {{ order.payout_method }}</p>
                            {% endif %}
                            
                            {% if order.payment_method %}
                            <p><strong>–°–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã:</strong> {{ order.payment_method }}</p>
                            {% endif %}
                            
                            {% if order.purpose %}
                            <p><strong>–¶–µ–ª—å:</strong> {{ order.purpose }}</p>
                            {% endif %}
                        </div>
                        <div class="col-md-6">
                            <p><strong>–°—Ç–∞—Ç—É—Å:</strong> 
                                {% if order.status == 'new' %}
                                    <span class="badge bg-warning">–ù–æ–≤–∞—è</span>
                                {% elif order.status == 'processing' %}
                                    <span class="badge bg-info">–í –æ–±—Ä–∞–±–æ—Ç–∫–µ</span>
                                {% elif order.status == 'completed' %}
                                    <span class="badge bg-success">–ó–∞–≤–µ—Ä—à–µ–Ω–∞</span>
                                {% elif order.status == 'cancelled' %}
                                    <span class="badge bg-danger">–û—Ç–º–µ–Ω–µ–Ω–∞</span>
                                {% else %}
                                    <span class="badge bg-secondary">{{ order.status }}</span>
                                {% endif %}
                            </p>
                            <p><strong>–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:</strong> {{ order.created_at.strftime('%d.%m.%Y %H:%M:%S') }}</p>
                            
                            {% if order.username %}
                            <p><strong>Username –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</strong> @{{ order.username }}</p>
                            {% endif %}
                            
                            {% if order.order_username %}
                            <p><strong>Username –∏–∑ –∑–∞—è–≤–∫–∏:</strong> {{ order.order_username }}</p>
                            {% endif %}
                            
                            {% if order.contact %}
                            <p><strong>–ö–æ–Ω—Ç–∞–∫—Ç:</strong> {{ order.contact }}</p>
                            {% endif %}
                            
                            {% if order.invoice_file_id %}
                            <p><strong>–ò–Ω–≤–æ–π—Å:</strong> 
                                <span class="badge bg-info">üìé –ü—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω ({{ order.invoice_file_type }})</span>
                            </p>
                            {% endif %}
                        </div>
                    </div>

                    {% if order.rate_snapshot %}
                    <div class="mt-3">
                        <h6>–°–Ω–∏–º–æ–∫ –∫—É—Ä—Å–∞:</h6>
                        <pre class="bg-light p-2 rounded">{{ order.rate_snapshot | tojson(indent=2) }}</pre>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>

        <div class="col-md-4">
            <div class="card">
                <div class="card-header">
                    <h5 class="mb-0">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ</h5>
                </div>
                <div class="card-body">
                    {% if order.first_name %}
                        <p><strong>–ò–º—è:</strong> {{ order.first_name }}</p>
                    {% endif %}
                    {% if order.username %}
                        <p><strong>Username:</strong> @{{ order.username }}</p>
                    {% endif %}
                    <p><strong>Telegram ID:</strong> {{ order.tg_id }}</p>
                    <p><strong>–Ø–∑—ã–∫:</strong> {{ order.lang }}</p>
                </div>
            </div>

            <div class="card mt-3">
                <div class="card-header">
                    <h5 class="mb-0">–ò–∑–º–µ–Ω–∏—Ç—å —Å—Ç–∞—Ç—É—Å</h5>
                </div>
                <div class="card-body">
                    <form method="POST" action="/admin/orders/{{ order.id }}/status">
                        <div class="mb-3">
                            <label for="status" class="form-label">–ù–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å:</label>
                            <select class="form-select" id="status" name="new_status" required>
                                <option value="new" {% if order.status == 'new' %}selected{% endif %}>–ù–æ–≤–∞—è</option>
                                <option value="processing" {% if order.status == 'processing' %}selected{% endif %}>–í –æ–±—Ä–∞–±–æ—Ç–∫–µ</option>
                                <option value="completed" {% if order.status == 'completed' %}selected{% endif %}>–ó–∞–≤–µ—Ä—à–µ–Ω–∞</option>
                                <option value="cancelled" {% if order.status == 'cancelled' %}selected{% endif %}>–û—Ç–º–µ–Ω–µ–Ω–∞</option>
                            </select>
                        </div>
                        <button type="submit" class="btn btn-primary">
                            <i class="bi bi-check-circle"></i> –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å
                        </button>
                    </form>
                </div>
            </div>

            <div class="card mt-3">
                <div class="card-header">
                    <h5 class="mb-0">–°–≤—è–∑—å —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º</h5>
                </div>
                <div class="card-body">
                    <div class="d-grid gap-2">
                        <a href="/admin/send-message?user_id={{ order.tg_id }}" class="btn btn-success">
                            <i class="bi bi-envelope"></i> –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
                        </a>
                        <a href="https://t.me/{{ order.username|replace('@', '') if order.username else order.tg_id }}" 
                           target="_blank" class="btn btn-outline-primary">
                            <i class="bi bi-telegram"></i> –ù–∞–ø–∏—Å–∞—Ç—å –≤ Telegram
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
</html> 